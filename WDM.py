from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys

from selenium.webdriver.common.alert import Alert
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC

opt = Options()
opt.add_experimental_option("debuggerAddress", "Localhost:9125")
driver = webdriver.Chrome(executable_path="D:\\KVS\\drivers\\chromedriver_win32\\chromedriver.exe",chrome_options=opt)
driver.get("https://ekharid.haryana.gov.in/FCI/WDM_AM_Bill")
bill = ["WDM_010423135348065WhUR21673","WDM_010423133957087WhUR21669","WDM_010423135555463WhUR21674","WDM_010423135145467WhUR21672","WDM_010423134833920WhUR21670","WDM_060423095327578WhUR21793","WDM_060423095520021WhUR21794","WDM_060423095752758WhUR21796","WDM_060423095914842WhUR21798","WDM_060423100505454WhUR21803","WDM_060423100239396WhUR21802","WDM_060423100040194WhUR21800","WDM_100423094138535WhUR21865","WDM_100423095327135WhUR21870","WDM_100423094713579WhUR21867","WDM_100423095048108WhUR21869","WDM_110423101417826WhUR21893","WDM_110423102421968WhUR21895","WDM_110423102936548WhUR21896","WDM_110423101834684WhUR21894","WDM_130423094822726WhUR0001","WDM_130423095320718WhUR21945","WDM_130423101706530WhUR21952","WDM_130423100831004WhUR21949","WDM_130423100544771WhUR21948","WDM_130423095947521WhUR21946","WDM_130423101257327WhUR21951","WDM_130423101109847WhUR21950","WDM_130423100305601WhUR21947","WDM_190423104019901WhUR0001","WDM_190423104351122WhUR22024","WDM_190423115137474WhUR22027","WDM_190423123212557WhUR22029","WDM_190423125726362WhUR22035","WDM_190423125956331WhUR22036","WDM_190423122620193WhUR22028","WDM_190423123714725WhUR22030","WDM_190423114308417WhUR22026","WDM_190423124541962WhUR22034","WDM_190423130430345WhUR22037","WDM_190423124405751WhUR22033","WDM_190423124209421WhUR22032","WDM_190423123950817WhUR22031"]
amt = ["7081","1227697","5102","50222","55397","197377","401330","192808","64723","1718","24457","21861","1821632","286756","1622114","818704","2062888","1813750","145785","86980","466979","457890","485269","53956","500161","316377","6692","58675","50404","450746","30191","588373","437488","19954","56753","415912","451211","680633","48559","42459","37993","40112","26850"]
for (a,b) in zip(bill,amt):
    driver.find_element(By.ID, "txtSearch").send_keys(a)
    driver.find_element(By.ID, "btn_Filter").click()
    driver.find_element(By.ID, "LnkDetails").click()
    driver.find_element(By.ID, "txt_Total_PayableAmount").send_keys(b)
    driver.find_element(By.ID, "txt_Reason").send_keys("Passed")
    driver.find_element(By.ID, "btnPassBill").click()
    WebDriverWait(driver, 10).until(EC.alert_is_present())
    driver.switch_to.alert.accept()

